###

# 1

在LTE网络中，eNodeB通常是分配系统带宽的一部分区域给特定的UE。即在一个特定时间、给UE分配特定的频率区域资源。此时，若eNodeB知道哪部分特定频率区域质量较好，优先分配给UE，将使UE的业务质量更有保障。此时，参考信号就可以为eNodeB的调度资源提供参考。

LTE的参考信号分为上行参考信号和下行参考信号。

1. #### 上行参考信号
  
  DM-RS(解调参考信号)和SRS（探测参考信号）, 上行参考信号用于两个目的：

- 上行信道估计，用于eNodeB端的相干解调和检测。
- 上行信道质量测量。

2. #### 下行参考信号
  

- 下行信道估计，用于UE端的相干检测和解调。
  
- 下行信道质量测量（信道探测）。
  
- 小区搜索
  

1. 小区专用参考信号（C-RS）：所有下行传输技术的信道估计和相关解调。在天线端口{0}或{0,1}或{0,1,2,3}上传输
  
2. 用户专用参考信号（UE-RS，又称DM-RS）：信道估计和相关解调。支持PDSCH的单天线端口传输，在天线端口5或7或8上传输
  
3. MBSFN参考信号：用于MBSFN的信道估计和相关解调。在天线端口{4}上传输
  
4. 位置参考信号（P-RS）：主要用于定位。在天线端口6上传输.
  

### CRS

    小区特定的参考信号对小区内的所有UE都有效。小区特定的参考信号序列由一系列的参考符号组成，每个参考符号占一个RE。
    位置：每个下行子帧都有，特殊子帧的下行导频时隙也有。在一个RB内，频域上每隔六个子载波一个参考信号，时域上每隔三个符号位一个，具体的位置排列跟CELLID有关，Shift=CELLID mod 6，CELLD=[0,503] 天线端口等于1时的参考信号位置：
    
    `LTE里面的天线端口（Antenna Port）是和参考信号一 一对应的，不一定与物理天线对应。对于UE而言，eNodeB侧有几根物理天线并不重要，重要的是获得从每一个antenna port到UE的一根天线之间的信道状态信息。在使用 CRS 的时候可以在每一个物理天线上分一个RS，这样在UE侧可以通过信道估计辨别出天线端口 0, 1, 2, 3。`
![p1](https://github.com/mjmj930/env-pkg/blob/doc/images/CRS%20location.png)

   ` 参考符号在每个RB内的起始位置和小区特定的频率偏移有关。LTE定义了6个频率偏移，其取值为 mod6(PCI)
，即各小区的物理小区ID模6。那么为什么要这样分配呢？原因在于这样可以避免至多6个相邻小区的小区特定参考信号之间的时频资源冲突和干扰，即所谓的“模6干扰”。为了有效地提高参考信号的SIR，可以让参考符号比周围其他非参考符号拥有更高的能量（可以有至多6dB的功率提升）。频率偏移以后，某个小区上的参考信号只会收到相邻其他小区非参考信号所带来的干扰，但是非参考信号的符号功率又相对比较小，这样就能提升参考信号的SIR

在单天线的时候，其实它也假设是同时存在天线端口0，1的，因此，对应到天线端口1的资源粒子是空着的，不能使用。这有个好处就是不会对其它配置系统（比如支持两天线端口的系统）的参考信号造成干扰，

![image](https://github.com/user-attachments/assets/715366cd-6e3c-4082-8cf0-e6e96e81bae8)

在双天线端口CRS配置中，如图所示，第0参考信号和第1参考信号在频域上是交错放置的。而且，下行参考信号的设计还必须有一定的正交性，以有效地支持多天线并行传输（最多需支持4个并行流），第2与第3参考信号在时域上错开放置。
https://github.com/mjmj930/env-pkg/blob/doc/images/%E5%8F%8C%E5%A4%A9%E7%BA%BF%E7%AB%AF%E5%8F%A3CRS%E9%85%8D%E7%BD%AE%E5%9B%BE.jpg


CRS本质上是终端已知的伪随机序列；对于每个天线端口，RS的频域间隔为6个子载波；被参考信号占用的RE，在其它天线端口相同RE上必须留空；天线端口增加时，系统的导频总开销也增加，可用的数据RE减少；LTE的参考信号是离散分布的，而CDMA/UMTS的导频信号是连续的；RS分布越密集，则信道估计越精确，但开销越大，影响系统容量。

### PA PB
LTE下行信道或符号的功率控制基于两种方式：静态方式和动态方式。所谓静态方式即为信道配置一个固定值，例如RS、PBCH、PCFICH、PSS+SSS信道采用静态值方式设置功率，并且PBCH、PCFICH、PSS+SSS信道功率值是相对于RS功率进行设置的一个偏置值。

而动态方式即所谓的功率分配，就是把基站总功率在某个时刻按照一定规则分配到各个信道上，例如PHICH、PDCCH, PDSCH信道。（注：PHICH、PDCCH, PDSCH信道既可以采用静态值方式也可以采用动态功率分配方式，采用哪种方式取决于PDCCH或PDSCH信道传输的内容。

那么什么是功率分配呢？ 首先，要明确一个概念，EPRE（即每RE上的能量）: Energy Per Resource Element，功率分配是基于EPRE的。

在时域上，由于OFDM符号是时分复用的，每个OFDM符号时刻（时域上=66.7us）都以基站的最大功率发射。但在系统带宽内，每个OFDM符号时刻包含多个OFDM符号（例如20MHz带宽，每个OFDM时刻包含1200个OFDM符号），那么每个OFDM符号可获取的发射功率为多少呢？于是就有了所谓的功率分配。

根据OFDM符号中是否存在RS信号，把PDSCH OFDM符号分为两类，即A类（TYPE A）和B类（TYPE B）。
![image](https://github.com/user-attachments/assets/c8030bea-714b-40a8-98f5-f31b94cc223f)
A类符号：不存在RS的PDSCH OFDM符号

B类符号：存在RS的PDSCH OFDM符号

ρA：将A类符号的PDSCH RE功率（单位mw）与RS功率(单位mW)比值记作ρA=

ρB：将B类符号的PDSCH RE功率（单位mw）与RS功率（单位mw）比值记作ρB=

LTE设备中，为了控制分配给UE的PDSCH RE功率，引入了PA参数，PB参数。PA是一个UE级参数，通过RRC信令发送给UE，可随时改变，PA越小则A类符号功率相对于RS符号功率比值越小；PB是一个小区级参数，由SIB2广播。

PA定义为：该参数表示PDSCH功率控制PA调整开关关闭且下行ICIC开关关闭时，PDSCH采用均匀功率分配时的PA值，数值上PA=10。

PB定义为：表示PDSCH上EPRE（Energy Per Resource Element）的功率因子比率指示，它和天线端口共同决定了功率因子比率的值，数值上PB表示ρB/ρA的索引。

   假定把基站分配给每个RB的功率均分为48份，则针对RS RE及PDSCH RE有如下分配情况：（2/4天线端口）


   第一图：[PA，PB]=[0,0]

每一列的功率总和算48个单位，因为PA=0，所以第二列数据RE和第一列的RS功率是一样的，图中都以4来表示，而第一列中有2个RE是不发的，因此多出来8个单位的功率，而这8个功率被均匀的分配到了8个数据RE上，因此第一列的8个数据RE都是5个单位的功率，因此ρB/ρA也就是5/4，这种情况比较少用。
    第二图: [PA，PB]=[-3,1]

就是把那2个RE空出来的8个功率分给了2个RS的RE，因此每个RS是8。相当于RS功率增加了1dB。这种配置是最常用的，保证RS的正确接收。
    第三图: [PA，PB]=[-4.77,2]，除了把那2个RE空出来的8个功率分给了2个RS的RE，还把B类符号的每个PDSCH RE功率的让出来2个单位给RS，相当于RS功率增加了2dB.

第四图: [PA，PB]=[-6,3]，除了把那2个RE空出来的8个功率分给了2个RS的RE，还把B类符号的每个PDSCH RE功率的让出来3个单位给RS,相当于RS功率增加了3dB.

因此上面2，3，4中分配方式可以看到RS被明显增强，因此对覆盖会有正增益，常用来做（超）远覆盖。这种方式也叫RS 功率Boosting技术。但同时对业务数据（TYPE B）是有负增益的，牺牲了部分容量。

根据上图，可以得到几个参数的组合情况：
![image](https://github.com/user-attachments/assets/600c3198-bfff-4015-a03e-b88b248f7374)
PA和PB的单位都是db， PA等于0，说明ρA和RS的功率比是1:1，-3说明比RS小一倍，-4.77就是1/3，-6就是1/4。ρA和ρB可以看成单位是dbm，它反映的是实际功率的比值。

下表为PA和PB参数设置对于业务信道数据传输功率利用率！换句话的意思：保障基站输出功率最大化且同类符号平均利用的效率模型。其中有4组参数可以是功率利用率最大化。分别是（PA ，PB）:（0，0）、(-3，1)、(-4.77，2)、(-6，3)。
![image](https://github.com/user-attachments/assets/ab515cb4-dddd-4698-bcb3-7a618ebae9f1)
从上面分析可以得出以下几个规律：

1、每个OFDM符号总体功率之和应该相同。即所有B类符号子载波功率+所有RS符号子载波功率=所有A类符号子载波功率，同一种符号的功率都应该相同，而最大化地分担基站功率。

 2、P B设置不同的值，实质对应了B类符号与A类符号的功率比。PB值越大（注意，PB值其实是一个索引值），则B类符号的功率比A类符号的功率的比值越小，由于OFDM符号子载波功率之和相同，因此相当于抬升了RS符号功率。 

 3、PA值与A类符号的功率和RS符号功率的比值有对应关系，根据2的推导，RS功率抬升，B类符号功率减小，若A类符号功率不变，则PA值将会减少。
 RS功率
RS功率是一个小区级参数，由网管配置，一旦确定就不受其他参数影响而改变，通过SIB2广播。

覆盖：RS设置过大会造成越区覆盖，对其他小区造成干扰；RS设置过小，会造成覆盖不足，出现 盲区；

干扰：由于受周围小区干扰影响，RS功率设置也不同，干扰大的地方需要留出更大的干扰余量；

信道估计：RS功率设置会影响信道估计。RS功率越大，信道估计精度越高，解调门限越低，接收机灵敏度越高，但是对邻区干扰也越大。 

容量：RS功率越高，覆盖越好，但用于数据传输的功率越小，会造成系统容量的下降； RS功率设置需要综合各方面因素，既要保证覆盖与容量的平衡，又要保证信道估计的有效性，还要保证干扰的合理控制。

三、参数设置
PB参数的含义及设置参考： PB取值越大，RS功率在原来的基础上抬升越高，能获得更好的信道估计，增强PDSCH的解调性能，但同时减少了PDSCH（TYPE B）的发射功率，合适的PB取值可以改善边缘用户速率，提高小区覆盖性能。

参数PA的含义及设置参考：

含义：PDSCH功控算法关闭，且静态ICIC算法关闭时，采用均匀功率分配，小区所有用户的PA 值。 PA取值越小，表示A类PDSCH 符号发射功率相对于RS功率越小。

界面取值范围：[-6, -4.77, -3, -1.77, 0, 1, 2, 3]

参数调整对网络性能的影响：均匀分配功率时，为了保证当下行带宽全部分配时，eNB功率正好用完，则每个RB上的功率应该等于eNB最大发射功率平摊到每个RB上的功率，而每个RB上的功率的绝对值是由PA和RS功率共同决定的，所以在eNB总功率不变的情况下，对于不同的RS功率（或者对于不同的RS功率抬升），为了尽量保证当下行带宽全部分配时，eNB功率尽可能用完，对所有UE设置的PA应不同。

RS功率一定时，增大该参数，增加了小区所有用户的功率，提高小区所有用户的MCS，

但可能造成功率受限，影响吞吐率；反之，降低小区所有用户的功率和MCS，降低小区吞吐率。
![image](https://github.com/user-attachments/assets/ff76e07d-bd77-413c-b866-106263dfcad4)

计算例子
 

1、  系统带宽20Mhz，（PA,PB）=（-3,1)，总功率40w，每个天线口的可用功率是40/8=5w时：
每个TypeA的RE的符号功率是=5w/1200=6.2dBm， Rs=9.2dBm，
每个TypeB的RE的符号功率是和TypeA一样的，是6.2dBm，

RS_Power=每通道发射功率+10lg（1+PB）-10lg（12*Nrb=9.2 dBm

当（PA，PB）=（0，0）时，
每个TypeA的RE的符号功率是=5w/1200=6.2dBm， Rs=6.2dBm，
每个TypeB的RE的符号功率是TypeA的1.25倍，是7.2dBm
RS_Power=每通道发射功率+10lg（1+PB）-10lg（12*Nrb）=6.2 dBm

 

2、以20M带宽，2*10W为例，推荐配置是Prs=12.2，PA=-3，PB=1，则单根天线上

的发射功率计算如下：

TypeA的RE的符号功率= RS PWR+PA=9.2 dBm

 

TypeB的RE的符号功率= TypeA的RE的符号功率+lg(ρB/ρA )

因为PB=1，单天线，所以ρB/ρA=4/5

TypeB的RE的符号功率= TypeA的RE的符号功率+10lg(ρB/ρA )=9.2+10lg(4/5)=9.2-1=8.2 dBm
---

    子载波：LTE采用的是OFDM技术，OFDM则是每个Symbol都对应一个正交的子载波，通过载波间的正交性来对抗干扰。协议规定，通常情况下子载波间隔15khz，Normal CP(Cyclic Prefix)情况下，每个子载波一个slot有7个symbol；Extend CP情况下，每个子载波一个slot有6个symbol。工作中，绝大多数碰到的，还是Normal CP，记住7个symbol就足够了。  
    RE(Resource Element)：频率上一个子载波及时域上一个symbol，称为一个RE。  
    RB(Resource Block)：频率上连续12个子载波，时域上一个slot，称为1个RB。根据一个子载波带宽是15k可以得出1个RB的带宽为180kHz。  
    REG（Resource Element Group）：一个REG包括4个连续未被占用的RE。REG主要针对PCFICH和PHICH速率很小的控制信道资源分配，提高资源的利用效率和分配灵活性。  
    CCE（Control Channel Element）：每个CCE由9个REG组成，之所以定义相对于REG较大的CCE，是为了用于数据量相对较大的PDCCH的资源分配。每个用户的PDCCH只能占用1，2，4，8个CCE，称为聚合级别。

小区特定的参考信号（Cell-specific Reference Signal），CRS，是为整个小区内的所有用户设备（UE）设计的，这意味着它们不是为单个UE定制的，而是小区内所有UE共同使用的。这种设计有以下几个含义：

1. **公共信号**：CRS是小区内所有UE都可以接收到的公共信号。它们不是为了某个特定UE设计的，而是为了让小区内的所有UE都能够使用这些信号来进行信道估计和数据解调。
  
2. **资源分配**：由于CRS是小区特定的，它们在资源分配上是共享的。这意味着小区内的每个UE都会使用相同的CRS进行信道估计，而不需要为每个UE单独分配参考信号。
  
3. **同步和标准化**：CRS的存在确保了小区内所有UE在信道估计和解调方面有一致的参考点。这有助于网络运营商标准化和同步小区内UE的操作，从而提高整体的网络性能。
  
4. **干扰管理**：通过使用CRS，网络可以更好地管理小区内的干扰。因为所有UE都使用相同的参考信号，网络可以预测和补偿由于多用户接入引起的干扰。
  
5. **网络优化**：CRS使得网络运营商能够优化小区的信号传输。例如，通过调整CRS的功率，网络可以影响小区的覆盖范围和信号质量，从而优化整个小区的性能。
  
6. **简化UE设计**：对于UE来说，它们不需要为每个小区或每个信号单独设计接收机制。这简化了UE的设计，因为它们可以依赖于小区特定的参考信号来进行信道估计和解调。
  
7. **兼容性和互操作性**：CRS的设计还考虑了不同UE和不同网络之间的兼容性和互操作性。这意味着无论UE的制造商或型号如何，它们都能够在同一个小区内正常工作。
  

---

    **相干检测**是一种信号的解调机制。利用调制信号的载波和接收到的已调信号相乘，然后通过低通滤波得到调制信号的检测方式。

    相干检测可检测强度，相位以及频率调制的光载无线信号。光信号在进入之前与接收端的本振激光器（LO）进行混频，产生一个等于本振激光器的频率和原光源频率之差的中频分量。

与直接检测相比，相干检测更容易获得大的信噪比，可恢复的信号种类较多，并且频率选择性较好，更适合系统。但相干检测获得较好的检测性质代价就是大大提高了系统的复杂性，而且缺乏灵活性。
